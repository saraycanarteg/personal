<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quotes Manager</title>
    <link rel="stylesheet" href="../styles/styleQuotes.css">
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
</head>

<body>
    <div class="quotes-container">
        <div class="quotes-header">
            <h2><i data-lucide="file-text"></i> Quotes</h2>
            <div class="header-actions">
                <div class="search-box">
                    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none"
                        stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="text" id="searchInput" placeholder="Search quotes...">
                </div>
                <select id="statusFilter" class="filter-select">
                    <option value="all">All Status</option>
                    <option value="approved">Approved</option>
                    <option value="pending">Pending</option>
                    <option value="rejected">Rejected</option>
                </select>
                <button class="btn-primary" onclick="quoteManager.showNewQuoteForm()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    New Quote
                </button>
            </div>
        </div>

        <div id="quotesList" class="table-container">
            <table>
                <thead>
                    <tr>
                        <th>Number</th>
                        <th>Client</th>
                        <th>Date</th>
                        <th>Total</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="quotesTableBody"></tbody>
            </table>
        </div>
    </div>

    <div id="quoteModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">New Quote</h3>
                <button class="btn-close" onclick="quoteManager.closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-row">
                    <div class="form-group">
                        <label>Client:</label>
                        <select id="clientSelect" class="input-field">
                            <option value="">-- Select client --</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Event Date:</label>
                        <input type="date" id="eventDate">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Number of People:</label>
                        <input type="number" id="numberOfPeople" value="50" min="1">
                    </div>
                    <div class="form-group">
                        <label>Discount (%):</label>
                        <input type="number" id="discount" value="0" min="0" max="100" step="0.1">
                    </div>
                </div>

                <div class="recipe-selection">
                    <h4>Select Recipes</h4>
                    <div class="table-container">
                        <table class="recipe-table">
                            <thead>
                                <tr>
                                    <th style="width: 50px;"></th>
                                    <th>Recipe</th>
                                    <th>Type</th>
                                    <th>Servings</th>
                                    <th>Cost/Serving</th>
                                    <th>Price/Serving</th>
                                </tr>
                            </thead>
                            <tbody id="recipesTableBody"></tbody>
                        </table>
                    </div>
                </div>

                <div class="cost-summary">
                    <div class="cost-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">$0.00</span>
                    </div>
                    <div class="cost-row">
                        <span>Discount (<span id="discountPercent">0</span>%):</span>
                        <span id="discountAmount">$0.00</span>
                    </div>
                    <div class="cost-row">
                        <span>Tax (15%):</span>
                        <span id="taxAmount">$0.00</span>
                    </div>
                    <div class="cost-row total">
                        <span>TOTAL:</span>
                        <span id="totalAmount">$0.00</span>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary" onclick="quoteManager.generatePDF()">Generate PDF</button>
                <button class="btn-secondary" onclick="quoteManager.closeModal()">Cancel</button>
            </div>
        </div>
    </div>

    <div id="detailModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Quote Details</h3>
                <button class="btn-close" onclick="quoteManager.closeDetailModal()">&times;</button>
            </div>
            <div class="modal-body">
                <div class="detail-section">
                    <h4>Client Information</h4>
                    <div class="detail-info">
                        <div class="detail-item">
                            <label>Quote Number:</label>
                            <span id="detailNumber"></span>
                        </div>
                        <div class="detail-item">
                            <label>Client:</label>
                            <span id="detailClient"></span>
                        </div>
                        <div class="detail-item">
                            <label>Date:</label>
                            <span id="detailDate"></span>
                        </div>
                        <div class="detail-item">
                            <label>Status:</label>
                            <span id="detailStatus"></span>
                        </div>
                    </div>
                </div>
                <div class="detail-section">
                    <h4>Summary</h4>
                    <div class="cost-summary">
                        <div class="cost-row total">
                            <span>TOTAL:</span>
                            <span id="detailTotal"></span>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn-primary btn-small">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                        <polyline points="14 2 14 8 20 8"></polyline>
                    </svg>
                    View PDF
                </button>
                <button class="btn-secondary btn-small" onclick="quoteManager.closeDetailModal()">Close</button>
            </div>
        </div>
    </div>

    <script>
        window.API_URL = 'https://t3-awd-recipe-management-system-2.onrender.com/api';
    </script>
    <script src="../scripts/scripQuotes.js"></script>

    <script>lucide.createIcons();</script>
</body>

</html>